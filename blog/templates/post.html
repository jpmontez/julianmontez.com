{% extends "base.html" %}

{% block content %}
  <article class="post {{ post.layout }}">
    <div class="post-header">
      {% if post.title %}
        <div class="title">{{ post.title }}</div>
      {% endif %}
    </div>

    {% if post.images_meta %}
      {% for image in post.images_meta %}
        {% set is_hero = loop.first %}
        <figure>
          <img
            src="{{ assets_prefix }}/{{ image.primary_src or image.path }}"
            alt="{{ post.title or 'Post image' }}"
            loading="{{ 'eager' if is_hero else 'lazy' }}"
            {% if is_hero %}
            fetchpriority="high"
            {% endif %}
            {% if image.srcset %}
            srcset="{% for variant, variant_width in image.srcset %}{{ assets_prefix }}/{{ variant }} {{ variant_width }}w{% if not loop.last %}, {% endif %}{% endfor %}"
            sizes="(max-width: 720px) 100vw, 520px"
            {% endif %}
            decoding="async"
            {% if image.width and image.height %}width="{{ image.width }}" height="{{ image.height }}"{% endif %}
          />
        </figure>
      {% endfor %}
    {% endif %}

    {% if post.excerpt %}
      <div class="excerpt">
        <p>{{ post.excerpt }}</p>
      </div>
    {% endif %}

    {% if post.body_html %}
      <div class="body">
        {{ post.body_html | safe }}
      </div>
    {% endif %}

    <div class="meta">
      {{ post.display_date }}
    </div>
  </article>

  <div class="feed-nav">
    <a href="{{ assets_prefix }}/">Back to feed</a>
  </div>
{% endblock %}
